# compress

Compress images with advanced quality control. Reduce file sizes significantly while maintaining visual quality through fine-grained compression settings.

## Usage

<Terminal commands={[{ command: 'mediaproc image compress <input> [options]' }]} />

## Description

The `compress` command provides aggressive image compression with fine-grained quality control. Unlike `optimize` which focuses on balanced size/quality trade-offs, `compress` allows you to push compression further for maximum file size reduction. Perfect for thumbnails, backgrounds, or situations where smaller file sizes are prioritized.

## Options

| Option          | Type   | Default                    | Description                                    |
| --------------- | ------ | -------------------------- | ---------------------------------------------- |
| `<input>`       | string | _required_                 | Input image file path                          |
| `-o, --output`  | path   | `<input>-compressed.<ext>` | Output file path                               |
| `-q, --quality` | number | 75                         | Compression quality (1-100)                    |
| `--lossy`       | flag   | -                          | Enable lossy compression for maximum reduction |
| `--dry-run`     | flag   | -                          | Preview changes without executing              |
| `-v, --verbose` | flag   | -                          | Show detailed output                           |

## Examples

### Basic Compression

<Terminal commands={[
  { command: 'mediaproc image compress photo.jpg' },
  { output: '✓ Compressed: 2.45 MB → 1.12 MB (54% reduction)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress image.png -q 60' },
  { output: '✓ Compressed: 845 KB → 312 KB (63% reduction)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress pic.jpg --lossy' },
  { output: '✓ Compressed: 3.2 MB → 890 KB (72% reduction)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress photo.webp -q 80 -o small.webp' },
  { output: '✓ Compressed: 1.8 MB → 945 KB (48% reduction)', isSuccess: true }
]} />

### Batch Compression

<Terminal commands={[
  { command: 'for img in *.jpg; do mediaproc image compress "$img" -q 70; done' },
  { output: '✓ Processed 15 images', isSuccess: true },
  { output: '✓ Total reduction: 18.5 MB → 6.2 MB (66%)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress large-image.jpg --lossy -o thumbnail.jpg' },
  { output: '✓ Compressed: 5.8 MB → 425 KB (93% reduction)', isSuccess: true }
]} />

### Format-Specific Examples

<Terminal title="JPEG Compression" commands={[
  { command: 'mediaproc image compress photo.jpg -q 75' },
  { output: '✓ Progressive encoding enabled', isSuccess: true },
  { output: '✓ Compressed: 2.4 MB → 1.1 MB (54%)', isSuccess: true }
]} />

<Terminal title="PNG Compression" commands={[
  { command: 'mediaproc image compress screenshot.png --lossy' },
  { output: '✓ Palette reduced to 256 colors', isSuccess: true },
  { output: '✓ Compressed: 892 KB → 234 KB (74%)', isSuccess: true }
]} />

<Terminal title="WebP Compression" commands={[
  { command: 'mediaproc image compress image.webp -q 60' },
  { output: '✓ Compressed: 1.5 MB → 580 KB (61%)', isSuccess: true }
]} />

<Terminal title="AVIF Compression" commands={[
  { command: 'mediaproc image compress photo.avif -q 70' },
  { output: '✓ Compressed: 2.2 MB → 512 KB (77%)', isSuccess: true }
]} />

## Quality Levels

### Recommended Settings

- **Quality 80-100**: High quality, moderate compression

  - Best for: Hero images, portfolios, print-ready
  - Typical reduction: 10-30%

- **Quality 60-79**: Good quality, good compression (recommended)

  - Best for: General web use, galleries, blogs
  - Typical reduction: 30-60%

- **Quality 40-59**: Lower quality, high compression

  - Best for: Backgrounds, decorative images
  - Typical reduction: 60-80%

- **Quality 1-39**: Low quality, maximum compression
  - Best for: Placeholders, low-priority assets
  - Typical reduction: 80-90%

### Lossy Mode

Enabling `--lossy` activates aggressive compression algorithms:

- JPEG: Uses MozJPEG for better compression
- PNG: Converts to indexed palette (256 colors)
- WebP: Switches to lossy encoding
- Results in visible artifacts but smallest files

## Format-Specific Behavior

### JPEG Compression

- Progressive encoding for faster loading
- MozJPEG optimization (with --lossy)
- Metadata stripping for size reduction

### PNG Compression

- Maximum compression level (9)
- Optional palette reduction (with --lossy)
- Alpha channel preservation

### WebP Compression

- Lossless by default
- Lossy mode for better compression
- Superior to JPEG at same quality

### AVIF Compression

- Next-generation format
- 50% smaller than JPEG
- Slower encoding, best quality

## Use Cases

### Web Optimization

<Terminal commands={[
  { command: 'mediaproc image compress hero.jpg -q 75 -o hero-web.jpg' },
  { output: '✓ Compressed: 3.2 MB → 1.4 MB (56% reduction)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress large.jpg -q 50 --lossy -o thumb.jpg' },
  { output: '✓ Compressed: 4.5 MB → 680 KB (85% reduction)', isSuccess: true }
]} />

### Social Media

<Terminal commands={[
  { command: 'mediaproc image compress photo.jpg -q 70 -o instagram.jpg' },
  { output: '✓ Compressed: 2.8 MB → 1.1 MB (61% reduction)', isSuccess: true }
]} />

<Terminal commands={[
  { command: 'mediaproc image compress pic.jpg -q 65 -o twitter.jpg' },
  { output: '✓ Compressed: 3.5 MB → 890 KB (75% reduction)', isSuccess: true }
]} />

### Email Attachments

<Terminal commands={[
  { command: 'mediaproc image compress photo.jpg -q 60 --lossy' },
  { output: '✓ Compressed: 2.5 MB → 420 KB (83% reduction)', isSuccess: true }
]} />

### Storage Optimization

<Terminal commands={[
  { command: 'for img in archive/*.jpg; do mediaproc image compress "$img" -q 65; done' },
  { output: '✓ Processed 247 images', isSuccess: true },
  { output: '✓ Total space saved: 1.2 GB', isSuccess: true }
]} />

## vs Optimize

### When to use `compress`:

- Need aggressive size reduction
- Quality is secondary to file size
- Creating thumbnails or previews
- Storage/bandwidth constrained
- Can tolerate some artifacts

### When to use `optimize`:

- Need best quality/size balance
- Want minimal quality loss
- Processing customer photos
- Professional photography
- SEO and UX matter

## Technical Details

### Compression Algorithms

**JPEG:**

- Baseline: Standard JPEG compression
- Progressive: Loads incrementally (better UX)
- MozJPEG: Advanced optimization (--lossy)

**PNG:**

- zlib compression (level 9)
- Palette optimization
- Color reduction (--lossy)

**WebP:**

- Lossless: Predictive coding
- Lossy: Transform coding like JPEG
- Better compression than JPEG/PNG

**AVIF:**

- AV1 image format
- Superior compression ratio
- Slower encoding time

### Output Information

The command displays:

- Original file size
- Compressed file size
- Reduction percentage
- Processing time (verbose mode)
- Quality settings used

## Tips

- **Quality 60-75** offers the best compression/quality trade-off for most use cases
- Use **--lossy** for thumbnails and backgrounds where quality matters less
- **WebP format** achieves better compression than JPEG at equivalent quality
- **Test different quality levels** to find the sweet spot for your specific images
- **Always keep originals** before compressing, especially with lossy mode
- **Combine with resize** for even greater size reduction
- **Use verbose mode** to see detailed compression statistics

## Troubleshooting

### File size not reducing much

- Try lower quality values (-q 50-60)
- Enable lossy mode (--lossy)
- Consider format conversion to WebP/AVIF
- Check if image is already optimized

### Quality too low

- Increase quality value (-q 80-90)
- Disable lossy mode
- Try optimize command instead
- Use original higher-resolution source

### Slow processing

- AVIF format is slower to encode
- Use JPEG/WebP for faster compression
- Process smaller images first
- Consider batch processing overnight

## See Also

- [optimize](./optimize) - Balanced size optimization
- [convert](./convert) - Format conversion
- [resize](./resize) - Resize before compressing
- [batch](./batch) - Batch process multiple images
